"""
tests/test_jacobian
"""

import pprint
from besmarts.core import geometry

# x1 = [[0,1,0]], [[0,0,0]], [[1,0,0]], [[1,1,0]]
x2 = [[.5,1,0]], [[.5,0,0]], [[1,.2,-.1]], [[1,1.3,0]]

result = geometry.jacobian2_torsion(
        *x2
)[0]
for row in geometry.jacobian2_reshape_to_matrix(result):
    print(*map("{: 10.4e}".format, row))

# psi4numpy and geomeTRIC give the following, which besmarts also gives
"""
-1.6205e-01  2.1066e-01 -3.8892e-01 -2.9709e-01 -7.0221e-02 -1.6259e+00  4.5914e-01 -1.4044e-01  2.0148e+00  0.0000e+00  0.0000e+00  0.0000e+00
 2.1066e-01  0.0000e+00  1.0533e+00 -2.1066e-01  0.0000e+00 -1.0533e+00  0.0000e+00  0.0000e+00  5.5511e-17  0.0000e+00  0.0000e+00  0.0000e+00
-3.8892e-01  1.0533e+00  1.6205e-01  1.9986e-01 -3.5110e-01  2.9709e-01  1.8906e-01 -7.0221e-01 -4.5914e-01  0.0000e+00  0.0000e+00  0.0000e+00
-2.9709e-01 -2.1066e-01  1.9986e-01  8.2690e-01 -1.3564e-01  1.6126e+00 -9.9949e-01  3.5679e-01 -1.9279e+00  4.6968e-01 -1.0493e-02  1.1542e-01
-7.0221e-02  0.0000e+00 -3.5110e-01 -1.3564e-01  2.6743e-01  4.5223e-01  5.0561e-01 -3.1728e-01  4.4718e-01 -2.9975e-01  4.9846e-02 -5.4831e-01
-1.6259e+00 -1.0533e+00  2.9709e-01  1.6126e+00  4.5223e-01 -1.0943e+00 -1.7356e+00  5.5386e-01  1.3168e+00  1.7489e+00  4.7229e-02 -5.1952e-01
 4.5914e-01  0.0000e+00  1.8906e-01 -9.9949e-01  5.0561e-01 -1.7356e+00  1.1543e+00 -7.4176e-01  1.9322e+00 -6.1398e-01  2.3615e-01 -3.8563e-01
-1.4044e-01  0.0000e+00 -7.0221e-01  3.5679e-01 -3.1728e-01  5.5386e-01 -7.4176e-01  5.1936e-01 -1.2238e+00  5.2541e-01 -2.0208e-01  1.3721e+00
 2.0148e+00  5.5511e-17 -4.5914e-01 -1.9279e+00  4.4718e-01  1.3168e+00  1.9322e+00 -1.2238e+00 -1.6737e+00 -2.0191e+00  7.7658e-01  8.1606e-01
 0.0000e+00  0.0000e+00  0.0000e+00  4.6968e-01 -2.9975e-01  1.7489e+00 -6.1398e-01  5.2541e-01 -2.0191e+00  1.4430e-01 -2.2565e-01  2.7022e-01
 0.0000e+00  0.0000e+00  0.0000e+00 -1.0493e-02  4.9846e-02  4.7229e-02  2.3615e-01 -2.0208e-01  7.7658e-01 -2.2565e-01  1.5223e-01 -8.2381e-01
 0.0000e+00  0.0000e+00  0.0000e+00  1.1542e-01 -5.4831e-01 -5.1952e-01 -3.8563e-01  1.3721e+00  8.1606e-01  2.7022e-01 -8.2381e-01 -2.9654e-01
"""

# however I think the cosv term is incorrect since w=p-o and the angle
# needs to use w=p-o, so the angle is 180-t which gives -cosv
# since they flipped a lot of signs around
# t2, t4
"""
-1.6205e-01  2.1066e-01 -3.8892e-01 -2.9709e-01 -7.0221e-02 -1.6259e+00  4.5914e-01 -1.4044e-01  2.0148e+00  0.0000e+00  0.0000e+00  0.0000e+00
 2.1066e-01  0.0000e+00  1.0533e+00 -2.1066e-01  0.0000e+00 -1.0533e+00  0.0000e+00  0.0000e+00  5.5511e-17  0.0000e+00  0.0000e+00  0.0000e+00
-3.8892e-01  1.0533e+00  1.6205e-01  1.9986e-01 -3.5110e-01  2.9709e-01  1.8906e-01 -7.0221e-01 -4.5914e-01  0.0000e+00  0.0000e+00  0.0000e+00
-2.9709e-01 -2.1066e-01  1.9986e-01 -8.6291e-01 -1.4863e-01 -1.7930e+00  6.9032e-01  1.7143e-01  1.6871e+00  4.6968e-01  1.8787e-01 -9.3936e-02
-7.0221e-02  0.0000e+00 -3.5110e-01 -1.4863e-01  5.2741e-01 -1.0426e+00  8.2030e-02 -3.3304e-01  1.4436e-02  1.3683e-01 -1.9436e-01  1.3793e+00
-1.6259e+00 -1.0533e+00  2.9709e-01 -1.7930e+00 -1.0426e+00  3.3551e-01  1.4029e+00  1.3122e+00 -3.5728e-01  2.0160e+00  7.8374e-01 -2.7532e-01
 4.5914e-01  0.0000e+00  1.8906e-01  6.9032e-01  8.2030e-02  1.4029e+00 -8.2408e-01 -1.2203e-01 -1.9973e+00 -3.2537e-01  4.0004e-02  4.0538e-01
-1.4044e-01  0.0000e+00 -7.0221e-01  1.7143e-01 -3.3304e-01  1.3122e+00 -1.2203e-01  3.3532e-01 -3.0981e-01  9.1050e-02 -2.2729e-03 -3.0016e-01
 2.0148e+00  5.5511e-17 -4.5914e-01  1.6871e+00  1.4436e-02 -3.5728e-01 -1.9973e+00 -3.0981e-01  4.8877e-01 -1.7045e+00  2.9538e-01  3.2765e-01
 0.0000e+00  0.0000e+00  0.0000e+00  4.6968e-01  1.3683e-01  2.0160e+00 -3.2537e-01  9.1050e-02 -1.7045e+00 -1.4430e-01 -2.2788e-01 -3.1145e-01
 0.0000e+00  0.0000e+00  0.0000e+00  1.8787e-01 -1.9436e-01  7.8374e-01  4.0004e-02 -2.2729e-03  2.9538e-01 -2.2788e-01  1.9664e-01 -1.0791e+00
 0.0000e+00  0.0000e+00  0.0000e+00 -9.3936e-02  1.3793e+00 -2.7532e-01  4.0538e-01 -3.0016e-01  3.2765e-01 -3.1145e-01 -1.0791e+00 -5.2330e-02
"""
